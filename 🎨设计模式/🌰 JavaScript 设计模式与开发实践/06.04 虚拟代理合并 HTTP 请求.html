<body>
  <input type="checkbox" id="1" />1 <input type="checkbox" id="2" />2
  <input type="checkbox" id="3" />3 <input type="checkbox" id="4" />4
  <input type="checkbox" id="5" />5 <input type="checkbox" id="6" />6
  <input type="checkbox" id="7" />7 <input type="checkbox" id="8" />8
  <input type="checkbox" id="9" />9
</body>
<script>
  /* ------------------------- 不用代理模式 ------------------------- */
  // (function(){
  //     const synchronousFile = id => console.log('开始同步文件，id 为：' + id)

  //     const checkboxes = document.getElementsByTagName('input');

  //     Array.from(checkboxes).forEach(checkboxItem => {
  //         checkboxItem.onclick = function(){
  //             this.checked === true && synchronousFile(this.id)
  //         }
  //     })
  // })()

  /* ------------------------- 代理模式------------------------- */
  (function () {
    const synchronousFile = (id) => console.log("开始同步文件，id 为：" + id);

    const proxySynchronousFile = (function () {
      let cache = []; // 保存一段时间内需要同步的 ID
      let timer = null; // 定时器

      return function (id) {
        cache.push(id);
        if (timer) return; // 保证不会覆盖已经启动的定时器

        timer = setTimeout(function () {
          synchronousFile(cache.join(","));
          clearTimeout(timer);
          timer = null;
          cache.length = 0;
        }, 2000);
      };
    })();

    const checkboxes = document.getElementsByTagName("input");
    Array.from(checkboxes).forEach((checkboxItem) => {
      checkboxItem.onclick = function () {
        if (this.checked === true) proxySynchronousFile(this.id);
      };
    });
  })();
</script>
