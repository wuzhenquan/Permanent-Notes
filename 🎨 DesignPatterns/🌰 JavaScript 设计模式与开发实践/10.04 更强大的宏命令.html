<html>
  <body>
    <button id="button">点我</button>
  </body>
  <script>
    const MacroCommand = function () {
      return {
        commandList: [],
        add(command) {
          this.commandList.push(command);
        },
        execute() {
          for (let i = 0, command; (command = this.commandList[i++]); ) {
            command.execute();
          }
        },
      };
    };

    // 子命令 1
    const openAcCommand = {
      execute() {
        console.log("打开空调");
      },
    };

    // 子命令 2
    // 电视和音响是连在一起的，所以可以用一个宏命令来组合打开电视和打开音响的命令
    const openTvCommand = {
      execute() {
        console.log("打开电视");
      },
    };
    const openSoundCommand = {
      execute() {
        console.log("打开音响");
      },
    };
    const macroCommand1 = MacroCommand();
    macroCommand1.add(openTvCommand);
    macroCommand1.add(openSoundCommand);

    // 子命令 3
    // 关门、打开电脑和登录 QQ
    const closeDoorCommand = {
      execute() {
        console.log("关门");
      },
    };
    const openPcCommand = {
      execute() {
        console.log("开电脑");
      },
    };
    const openQQCommand = {
      execute() {
        console.log("登陆 QQ");
      },
    };
    const macroCommand2 = MacroCommand();
    macroCommand2.add(closeDoorCommand);
    macroCommand2.add(openPcCommand);
    macroCommand2.add(openQQCommand);

    // 组合子命令
    const superMacroCommand = MacroCommand();
    superMacroCommand.add(openAcCommand);
    superMacroCommand.add(macroCommand1);
    superMacroCommand.add(macroCommand2);

    // 绑定命令
    const setCommand = (function () {
      document.getElementById("button").onclick = () => command.execute();
    })(superMacroCommand);
  </script>
</html>
