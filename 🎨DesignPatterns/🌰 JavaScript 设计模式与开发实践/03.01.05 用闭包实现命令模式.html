<html>
  <body>
    <button id="execute">点击我打执行命令</button>
    <button id="undo">点我执行命令</button>
  </body>
  <script>
    /* --- 面向对象的命令模式 --- */
    // 命令发起者(执行者)
    var Tv = {
      open: function () { console.log("打开电视机"); },
      close: function () { console.log("关闭电视机"); },
    };

    // 命令接收者
    var OpenTvCommand = function (receiver) {
      this.receiver = receiver;
    };
    OpenTvCommand.prototype.execute = function () {
      this.receiver.open();
    };
    OpenTvCommand.prototype.undo = function () {
      this.receiver.close();
    };

    // 请求
    var setCommand = function (command) {
      document.getElementById("execute").onclick = () => command.execute();
      document.getElementById("undo").onclick = () => command.undo();
    };

    setCommand(new OpenTvCommand(Tv));

    /* --- 闭包方式的命令模式 --- */
    /* 如果需要往函数对象中预先植入命令的接收者 那么闭包可以完成这个工作 */

    // 命令发起者(执行者)
    var Tv = {
      open: () => console.log("打开电视机"),
      close: () => console.log("关闭电视机"),
    };

    // 命令接收者会被封闭在闭包形成的环境中
    var createCommand = (receiver) => ({
      execute: () => receiver.open(),
      undo: () => receiver.close(),
    });

    // 请求
    var setCommand = function (command) {
      document.getElementById("execute").onclick = () => command.execute();
      document.getElementById("undo").onclick = () => command.undo();
    };
    setCommand(createCommand(Tv));
  </script>
</html>
